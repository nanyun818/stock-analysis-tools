# 股票可视化分析与交易工具使用说明

## 📋 目录
- [功能概述](#功能概述)
- [环境准备](#环境准备)
- [券商配置](#券商配置)
- [使用指南](#使用指南)
- [注意事项](#注意事项)
- [常见问题](#常见问题)

## 🎯 功能概述

本工具集成了股票数据分析和实盘交易功能，支持：

### 📊 数据分析功能
- 实时股票行情获取
- K线图可视化显示
- 技术指标计算与分析
- 智能分析报告生成
- 热门股票推荐

### 💰 交易功能
- 支持华泰证券、佣金宝、银河证券
- 雪球模拟盘交易测试
- 实时买卖操作
- 持仓查询管理
- 交易记录追踪

## 🔧 环境准备

### 1. 安装Python依赖

运行 `install_trading_deps.bat` 或手动安装：

```bash
pip install pandas numpy matplotlib tkinter
pip install akshare
pip install easytrader
pip install easyquant
pip install requests beautifulsoup4 lxml
```

### 2. 华泰/佣金宝额外依赖

华泰证券和佣金宝需要验证码识别功能，需要安装以下之一：

**方案一：安装 tesseract**
- 下载：https://github.com/UB-Mannheim/tesseract/wiki
- 安装后添加到系统PATH

**方案二：安装 ddddocr**
```bash
pip install ddddocr
```

## 🏦 券商配置

### 华泰证券配置 (ht.json)

```json
{
    "user": "你的华泰证券账号",
    "password": "你的登录密码",
    "comm_password": "你的通讯密码",
    "trdpwd": "加密后的交易密码",
    "account": "你的资金账号"
}
```

**重要说明：**
- `trdpwd` 需要是加密后的交易密码
- 首次配置需要登录华泰网站查看POST请求中的trdpwd值
- 建议使用浏览器开发者工具获取加密密码

### 佣金宝配置 (yjb.json)

```json
{
    "user": "你的佣金宝账号",
    "password": "加密后的密码",
    "account": "你的资金账号"
}
```

**重要说明：**
- `password` 需要是加密后的密码
- 可通过浏览器登录后查看网络请求获取

### 银河证券配置 (yh.json)

```json
{
    "user": "你的银河证券账号",
    "password": "你的登录密码",
    "account": "你的资金账号"
}
```

### 雪球模拟盘配置 (xq.json)

```json
{
    "username": "你的雪球用户名",
    "password": "你的雪球密码",
    "portfolio_code": "你的组合代码",
    "portfolio_market": "cn"
}
```

**获取组合代码：**
1. 登录雪球网站
2. 进入模拟交易页面
3. 创建或选择一个组合
4. 从URL中获取组合代码

## 📖 使用指南

### 1. 启动程序

双击 `启动交易工具.bat` 或运行：
```bash
python trading_stock_visualizer.py
```

### 2. 配置券商连接

1. **选择券商类型**：从下拉菜单选择（华泰证券/佣金宝/银河证券/雪球模拟）
2. **选择配置文件**：点击"选择"按钮，选择对应的JSON配置文件
3. **连接券商**：点击"连接券商"按钮建立连接

### 3. 股票分析

1. **搜索股票**：
   - 在搜索框输入6位股票代码（如：000001）
   - 点击"搜索"或按回车键

2. **查看热门股票**：
   - 点击"刷新热门股票"获取当日涨幅榜
   - 双击列表中的股票快速选择

3. **分析功能**：
   - **概览**：查看欢迎信息和使用指南
   - **K线图**：查看股票K线走势图
   - **技术指标**：查看MA、RSI等技术指标
   - **分析报告**：查看智能生成的分析建议

### 4. 执行交易

1. **设置交易参数**：
   - 交易数量：输入要买卖的股数（必须是100的整数倍）
   - 交易价格：系统会自动填入当前价格，也可手动修改

2. **执行买卖**：
   - 点击"买入"或"卖出"按钮
   - 确认交易信息
   - 查看交易结果

3. **查询持仓**：
   - 点击"查询持仓"查看当前持有股票
   - 查看成本价、市值等信息

4. **交易记录**：
   - 在"交易记录"标签页查看历史交易
   - 包含时间、操作、股票、数量、价格等信息

## ⚠️ 注意事项

### 安全提醒
1. **配置文件安全**：
   - 配置文件包含敏感信息，请妥善保管
   - 不要将配置文件上传到公共代码仓库
   - 建议定期更改密码

2. **交易风险**：
   - 股市有风险，投资需谨慎
   - 建议先使用雪球模拟盘测试
   - 不要投入超过承受能力的资金

3. **技术限制**：
   - 程序仅供学习和研究使用
   - 不保证交易的及时性和准确性
   - 重要交易建议手动确认

### 使用限制
1. **交易时间**：只能在股市开盘时间进行交易
2. **网络要求**：需要稳定的网络连接
3. **券商限制**：不同券商可能有不同的API限制

## ❓ 常见问题

### Q1: 连接券商失败怎么办？
**A1:** 
- 检查配置文件格式是否正确
- 确认账号密码是否正确
- 检查网络连接是否正常
- 确认券商服务是否正常

### Q2: 获取股票数据失败？
**A2:**
- 检查股票代码是否正确（6位数字）
- 确认网络连接正常
- 检查AKShare是否正常安装
- 尝试刷新或重新搜索

### Q3: 华泰证券密码加密问题？
**A3:**
- 使用浏览器登录华泰网站
- 打开开发者工具（F12）
- 查看Network标签页的登录请求
- 找到POST请求中的trdpwd值

### Q4: 验证码识别失败？
**A4:**
- 确认已安装tesseract或ddddocr
- 检查tesseract是否添加到PATH
- 尝试手动输入验证码

### Q5: 交易失败怎么办？
**A5:**
- 检查账户余额是否充足
- 确认股票代码和数量是否正确
- 检查是否在交易时间内
- 查看券商返回的错误信息

## 📞 技术支持

如遇到技术问题，可以：
1. 查看程序运行日志
2. 检查配置文件格式
3. 参考easytrader官方文档
4. 在相关技术社区寻求帮助

## 📄 免责声明

本工具仅供学习和研究使用，使用者应当：
- 自行承担投资风险
- 遵守相关法律法规
- 不将工具用于非法用途
- 理解程序可能存在的bug和限制

**投资有风险，入市需谨慎！**